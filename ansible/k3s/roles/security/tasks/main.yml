---
- name: Security hardening
  tags: security
  vars:
    enable_module_signing: true
    attestation_endpoint: "https://api.example.com/attestation"
    attestation_interval: 900  # 15 minutes
    module_monitoring: true
  block:
    - name: Include mount restrictions
      ansible.builtin.include_tasks: mount-restrictions.yml
      tags: mount-restrictions

    - name: Include OPA policy setup
      ansible.builtin.include_tasks: opa-setup.yml
      tags: opa-setup

    - name: Module signing
      ansible.builtin.include_tasks: opa-setup.yml
      tags: opa-setup
    
    - name: AppArmor module control
      ansible.builtin.include_tasks: opa-setup.yml
      tags: opa-setup

    - name: Attestation integration
      ansible.builtin.include_tasks: opa-setup.yml
      tags: opa-setup