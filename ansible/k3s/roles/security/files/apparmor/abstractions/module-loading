# AppArmor abstraction for module loading control

  # Allow reading module state
  /proc/modules r,
  /sys/module/ r,
  /sys/module/** r,
  
  # Allow modprobe/insmod for specific binaries only
  /sbin/modprobe ix,
  /sbin/insmod ix,
  /sbin/rmmod ix,
  
  # Module files - read only
  /lib/modules/** r,
  
  # Deny direct module loading syscalls from most processes
  deny capability sys_module,