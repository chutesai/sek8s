[Unit]
Description=Initialize k3s Configuration
Before=k3s.service
After=network-online.target cloud-init.service admission-controller.service
Wants=network-online.target
# Need cloud final to have set hostname
Requires=cloud-final.service
After=cloud-final.service

[Service]
Type=oneshot
RemainAfterExit=yes
ExecStart=/usr/local/bin/k3s-config-init.sh
StandardOutput=journal
StandardError=journal
TimeoutStartSec=300

[Install]
WantedBy=multi-user.target
RequiredBy=k3s.service